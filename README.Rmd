---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# LAGOSNEgis

[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)[![CRAN status](https://www.r-pkg.org/badges/version/LAGOSNEgis)](https://cran.r-project.org/package=LAGOSNEgis)[![Travis build status](https://travis-ci.org/jsta/LAGOSNEgis.svg?branch=master)](https://travis-ci.org/jsta/LAGOSNEgis)

Extra functions to interact with the GIS module of LAGOSNE.

## Features

* Queries are optimized for speed using `SQL` statements rather than loading entire layers

* Repeated calls to a function with the same arguments are fast because function outputs are cached (_memoised_)

## Installation

```{r eval=FALSE}
remotes::install_github("jsta/LAGOSNEgis")
```

## Setup

_Optional: Place data at the location returned from `LAGOSNEgis:::gis_path_default()`_

## Usage

```{r }
library(LAGOSNEgis)
```

### List available GIS layers

```{r eval=FALSE}
sf::st_layers(LAGOSNEgis:::gis_path_default()
```

```{r echo=FALSE}
ly <- sf::st_layers(LAGOSNEgis:::gis_path_default())
knitr::kable(data.frame(ly[c("name", "driver", "features", "fields")]))
```

### Query from a specfic layer

```{r eval=FALSE}
res_iws  <- query_gis("IWS", "lagoslakeid", c(34352))
res_lake <- query_gis("LAGOS_NE_All_Lakes_4ha", "lagoslakeid", 34352)
res_pnt  <- query_gis("LAGOS_NE_All_Lakes_4ha_POINTS", "lagoslakeid", 34352)
```

### Query a combined watershed and lake polygon

```{r eval=FALSE}
res <- query_wbd(lagoslakeid = c(7010))
```

### Flexible queries using `SQL` statements

```{r eval=FALSE}
res <- query_gis_(query = "SELECT * FROM IWS WHERE lagoslakeid IN ('7010');")
```

## References
Soranno P., K. Cheruvelil. 2017. LAGOS-NE-GIS v1.0: A module for LAGOS-NE, a multi-scaled geospatial and temporal database of lake ecological context and water quality for thousands of U.S. Lakes: 2013-1925. Environmental Data Initiative. http://dx.doi.org/10.6073/pasta/fb4f5687339bec467ce0ed1ea0b5f0ca. Dataset accessed 9/26/2017.
